<div class="container-sm pt-5 todo-list-project"
     data-project-id="{{ project.id }}">
    <div class="project-border text-white p-2 project-gradient-blue-dark header-text-shadow d-flex align-items-center">
        <div class="col-2 col-md-1 d-flex justify-content-center">
            <i class="bi bi-calendar4 fs-4"></i>
        </div>
        <div class="col-8 col-md-10 d-flex align-items-center">
            <h4 class="mb-0 project-title"
                hx-get="{% url 'projects:update' project.pk %}"
                hx-target="this"
                hx-swap="outerHTML"
                style="cursor: pointer;"
                title="Click to edit title">
                {{ project.title }}
            </h4>
        </div>
        <div class="col-2 col-md-1 d-flex justify-content-end align-items-center gap-3 px-4">
            <i class="bi bi-pen text-light-white fa-lg edit-project-btn"
               aria-hidden="true"
               data-project-id="{{ project.id }}"
               style="cursor: pointer;"
               title="Edit project title"></i>
            <span class="vr opacity-50 mx-2"></span>
            <i class="bi bi-trash3 text-light-white fa-lg delete-project-btn"
               aria-hidden="true"
               data-project-id="{{ project.id }}"
               style="cursor: pointer;"
               title="Delete project"></i>
            {% csrf_token %}
        </div>
    </div>
    {# Creating task #}
    <div class="container-md">
        <div class="row white-border">
            <div class="col-md-12 p-2 project-gradient-grey-white project-text-shadow d-flex align-items-center">
                <div class="col-2 col-md-1 d-flex justify-content-center fs-1">
                    <svg
                            xmlns="http://www.w3.org/2000/svg"
                            width="40"
                            height="40"
                            stroke="currentColor"
                            stroke-width="4"
                            color="#5d9275"
                            viewBox="0 0 24 24"
                    >
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                </div>
                <div class="col-7 col-md-9 ">
                    <input type="text"
                           class="form-control search-shadow"
                           placeholder="Start typing here to create a task..."
                           id="searchInput-{{ project.id }}"
                           name="searchInput-{{ project.id }}">
                </div>
                <div class="col-3 col-md-2 d-flex justify-content-center">
                    <button type="button"
                            class="btn btn-success gradient-green-dark green-border"
                            hx-post="{% url 'tasks:create_simple' project.id %}"
                            hx-target="#tasks-container-{{ project.id }}"
                            hx-swap="beforeend"
                            hx-include="[name='searchInput-{{ project.id }}']"
                            hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'
                            hx-trigger="click"
                            hx-on="htmx:afterRequest: if (event.detail.xhr && event.detail.xhr.status === 200) { const input = document.getElementById('searchInput-{{ project.id }}'); if (input) { input.value = ''; } const msg = document.getElementById('no-tasks-message-{{ project.id }}'); if (msg) { msg.remove(); } if (window.dashboardManager) { window.dashboardManager.rebindEventHandlers(); window.dashboardManager.initSortableLists(); } }">
                        Add Task
                    </button>
                </div>
            </div>
        </div>
    </div>
    <div class="container-md shadow rounded-bottom-only todo-list"
         id="tasks-container-{{ project.id }}">
        {% if project.tasks.all %}
            {% for task in project.tasks.all %}
                {% include 'task/task_item.html' with task=task %}
            {% endfor %}
        {% else %}
            <div class="text-muted text-center py-3"
                 id="no-tasks-message-{{ project.id }}">
                <small>No tasks yet. Add your first task above!</small>
            </div>
        {% endif %}
    </div>
</div>